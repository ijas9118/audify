<div class="container my-5 col-8">
  <nav aria-label="breadcrumb"></nav>
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="/">Home</a></li>
      <li class="breadcrumb-item active" aria-current="page">Checkout</li>
    </ol>
  </nav>
  <h1 class="mb-4">Checkout</h1>
  
  <!-- Cart Summary -->
  <div class="checkout-summary mb-4">
    <h4 class="mb-3">Your Cart</h4>
    <% cart.items.forEach(item => { %>
      <div class="card mb-3">
        <div class="card-body d-flex justify-content-between align-items-center">
          <div class="d-flex align-items-center">
            <img src="<%= item.image %>" alt="<%= item.name %>" class="me-3" style="width: 100px; height: 100px; object-fit: contain;">
            <div>
              <h5 class="mb-1"><%= item.name %></h5>
              <p class="mb-1">₹<%= item.price.toFixed(2) %> x <%= item.quantity %></p>
            </div>
          </div>
          <p class="mb-0">Subtotal: ₹<%= item.subtotal.toFixed(2) %></p>
        </div>
      </div>
    <% }); %>
    <div class="d-flex justify-content-end mt-3 total">
      <h4>Total: ₹<%= cart.total.toFixed(2) %></h4>
    </div>
  </div>

  <form id="checkoutForm" action="/checkout" method="POST">
    <!-- Address Selection -->
    <div class="mb-4">
      <h4 class="mb-3">Select Address</h4>
      <div class="row">
        <% addresses.forEach(address => { %>
          <div class="col-md-4 mb-3 d-flex">
            <div class="card flex-fill address-card <% if (address.isDefault) { %> active-address <% } %>" data-id="<%= address._id %>">
              <div class="card-body d-flex flex-column">
                <h5 class="card-title">
                  <% if (address.isDefault) { %>
                    <%= address.customName || address.addressType.charAt(0).toUpperCase() + address.addressType.slice(1) %> (Default)
                  <% } else { %>
                    <%= address.customName || address.addressType.charAt(0).toUpperCase() + address.addressType.slice(1) %>
                  <% } %>
                </h5>
                <p class="card-text flex-grow-1">
                  <%= address.location %>, <%= address.city %>, <%= address.state %>, <%= address.country %> - <%= address.zip %>
                </p>
              </div>
            </div>
          </div>
        <% }); %>        
      </div>
    </div>

    <input type="hidden" name="selectedAddressId" id="selectedAddressId">
   
    <div class="container my-5">
      <div class="mb-4">
        <h4 class="mb-3">Payment Method</h4>
        <div class="row payment-methods col-8">
          <!-- Payment Method 1 -->
          <div class="col-md-6 mb-3">
            <div class="payment-card d-flex align-items-center p-3 rounded" data-method="Card">
              <i class="fas fa-credit-card fa-2x"></i>
              <span class="ms-3 fs-5">Card</span>
            </div>
          </div>

          <!-- Payment Method 2 -->
          <div class="col-md-6 mb-3">
            <div class="payment-card d-flex align-items-center p-3 rounded" data-method="UPI">
              <i class="fas fa-mobile-alt fa-2x"></i>
              <span class="ms-3 fs-5">UPI</span>
            </div>
          </div>

          <!-- Payment Method 3 -->
          <div class="col-md-6 mb-3">
            <div class="payment-card d-flex align-items-center p-3 rounded" data-method="Wallet">
              <i class="fas fa-wallet fa-2x"></i>
              <span class="ms-3 fs-5">Wallet</span>
            </div>
          </div>

          <!-- Payment Method 4 -->
          <div class="col-md-6 mb-3">
            <div class="payment-card d-flex align-items-center p-3 rounded highlighted" data-method="Cash On Delivery">
              <i class="fa-solid fa-money-bill-1 fa-2x"></i>
              <span class="ms-3 fs-5">Cash On Delivery</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Hidden Input for Payment Method -->
    <input type="hidden" name="paymentMethod" id="paymentMethod" />

    <!-- Apply Coupon -->
    <div class="mb-4 col-5">
      <h4 class="mb-3">Apply Coupon</h4>
      <div class="input-group">
        <input type="text" id="couponCode" class="form-control" placeholder="Enter coupon code" aria-label="Coupon code">
        <button id="applyCoupon" class="btn btn-dark" type="button">Apply</button>
      </div>
    </div>

    <!-- Place Order Button -->
    <div class="d-flex justify-content-start col-5">
      <button id="placeOrder" class="btn btn-dark btn-lg w-100" type="submit">Place Order</button>
    </div>
  </form>
</div>

<style>
  .payment-card {
  transition: all 0.3s ease;
  cursor: pointer;
  background-color: #f8f9fa; /* Light background color for the cards */
}

.payment-card:hover {
  background-color: #e9ecef;
  border-color: #0056b3;
}

.payment-card.highlighted {
  box-shadow: 0 0 10px rgba(200, 150, 255, 0.6); /* Light purple glow */
  border: 1px solid rgba(200, 150, 255, 0.3); /* Optional: Add a light purple border */
  transition: all 0.3s;
}

.payment-card i {
  color: #9166e0;
  transition: color 0.3s ease;
}
.address-card {
    cursor: pointer;
    border: 2px solid transparent;
    transition: background-color 0.3s ease, border-color 0.3s ease;
    border-radius: 0.375rem; 
  }
  
  .address-card.active-address {
    box-shadow: 0 0 10px rgba(0, 123, 255, 0.5); 
    border-color: #007bff;
  }
  
  .address-card:hover {
    background-color: #f8f9fa; 
  }
</style>

<script src="/js/checkout.js"></script>